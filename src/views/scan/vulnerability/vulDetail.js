import React, { useState } from 'react';
import { useEffect } from 'react';
import axiosClient from '../../../axiosClient';
import { Link, useLocation } from 'react-router-dom';
import queryString from 'query-string';
import { Row, Col, Card, Table, Button, Form } from 'react-bootstrap';
import { StopIcon, InfoIcon, DeleteIcon } from '../../../components/Icon/Icon';
import Modal from 'react-bootstrap/Modal';


function Detail() {
  const { search } = useLocation();
  // console.log(search);
  const values = queryString.parse(search);
  // console.log(values);
  // console.log(values.target_id);
  const [listVuls, setlistVuls] = useState([]);
  useEffect(() => {
    async function getItem() {
      const url = values.target_id ? `targets/${values.target_id}/scans` : 'scans';
      const res = await axiosClient.get(url);

      // console.log(res.data.items);
      setlistVuls((listVuls) => [...res.data.items]);
      // console.log(listResults);
    }
    getItem();
  }, [values.target_id]);
  function playScan(id) {
    console.log(id);
    const res = axiosClient.get(`/scans/${id}/start`);
    console.log(res);
  }
  return (
    <React.Fragment>
      <Row>
        <Col>
          <Card>
            <Card.Header>
              <Row>
                <Card.Title as="h5">Danh sách rà soát</Card.Title>

                <Link
                  title="Thêm rà soát mới"
                  to={'/scan/vulnerability/addScan'}
                  className="feather icon-plus-circle text-primary f-15 m-r-5"
                  style={{ fontSize: '20px' }}
                ></Link>
              </Row>
            </Card.Header>
            <Card.Body>
              <Table responsive hover>
                <thead>
                  <tr>
                    <th className="border-0">ID</th>
                    <th className="border-0">Tên miền</th>
                    <th className="border-0">Trạng thái</th>
                    <th className="border-0">Thời gian</th>
                    <th className="border-0">Kết quả rà soát</th>
                    <th className="border-0"></th>
                  </tr>
                </thead>
                <tbody>
                  {listVuls &&
                    listVuls.map((item) => {
                      return (
                        <tr key={item.id}>
                          <td>{item.id}</td>
                          <td>{item.address}</td>
                          <td className={String(item.status) === 'success' ? 'text-success' : 'text-warning'}>{String(item.status)}</td>
                          {/* <td>{String(item.status)}</td> */}
                          <td>{item.created_at}</td>
                          <tr style={{ backgroundColor: '#f2f2f200' }}>
                            <button
                              type="button"
                              style={{ borderRadius: '50%', padding: '4px 10px', marginTop: 10 }}
                              title="Nguy hiểm cao"
                              class="btn btn-danger btn-circle btn-sm"
                            >
                              {item.high}
                            </button>

                            <button
                              type="button"
                              style={{ borderRadius: '50%', padding: '4px 10px', marginTop: 10 }}
                              title="Nguy hiểm trung bình"
                              class="btn btn-warning btn-circle btn-sm"
                            >
                              {item.medium}
                            </button>
                            <button
                              type="button"
                              style={{ borderRadius: '50%', padding: '4px 10px', marginTop: 10 }}
                              title="Nguy hiểm thấp"
                              class="btn btn-primary btn-circle btn-sm"
                            >
                              {item.low}
                            </button>
                            <button
                              type="button"
                              style={{ borderRadius: '50%', padding: '4px 10px', marginTop: 10 }}
                              title="Nguy cơ"
                              class="btn btn-success btn-circle btn-sm"
                            >
                              {item.information}
                            </button>
                          </tr>
                        </tr>
                      );
                    })}
                </tbody>
              </Table>
            </Card.Body>
          </Card>
        </Col>
      </Row>
    </React.Fragment>
  );
}

export default Detail;
